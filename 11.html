<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Deposit & Pay - DIUWINNER</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            /* Updated Colors based on screenshots */
            --primary-dark-bg: #363636; /* Dark background for the entire page */
            --card-dark-bg: #404040; /* Slightly lighter dark for cards/sections */
            --header-bg: #404040; /* Header background matches card */
            --red-button: #dc3545; /* Red color for primary buttons */
            --red-button-hover: #c82333; /* Darker red on hover */
            --green-text-accent: #28a745; /* Green for winning/success */
            --yellow-accent: #ffc107; /* Yellow for balance/jackpot */
            --text-light: #ffffff; /* White text for most elements */
            --text-subtle: #b0b0b0; /* Light grey for subtle text */
            --border-dark: #555555; /* Darker border for separation */
            --input-bg: #4a4a4a; /* Darker background for inputs */
            --input-border: #666666;
            --shadow-dark: 0 4px 8px rgba(0,0,0,0.3); /* Darker shadow */

            /* Deposit Page Specific */
            --channel-active-bg: #28a745; /* Green for active channel */
            --channel-inactive-bg: #5a5a5a; /* Darker grey for inactive channels */

            /* Deposit History Page Specific */
            --filter-button-bg: #5a5a5a; /* Darker grey for inactive filter buttons */
            --filter-button-active-bg: var(--red-button); /* Red for active filter button */
            --filter-button-active-text: var(--text-light);
            --status-processing: #ffc107;
            --status-success: #28a745;
            --status-failed: #dc3545;

            /* Month Picker Specific Styles (adjusted for dark theme) */
            --month-picker-bg: var(--card-dark-bg);
            --month-picker-header-bg: var(--red-button); /* Use red for picker header */
            --month-picker-header-text: var(--text-light);
            --month-picker-month-active-bg: var(--green-text-accent); /* Green for active month */
            --month-picker-month-text: var(--text-light); /* Light text on dark month items */
            --month-picker-button-text: var(--red-button); /* Red for picker action buttons */
            --month-item-bg: #5a5a5a; /* Darker grey for inactive months */
            --month-item-hover-bg: #6a6a6a;

            /* Chat Specific (already dark-friendly, adjust if needed) */
            --chat-bg: var(--card-dark-bg); /* Same as card bg */
            --chat-border: #555555;
            --chat-header-bg: #5a5a5a;
            --chat-message-bg-outgoing: #28a745; /* Green for outgoing */
            --chat-message-bg-incoming: #5a5a5a; /* Darker grey for incoming */

            /* Date Range Picker Modal Specific Styles */
            --modal-overlay-bg: rgba(0, 0, 0, 0.7); /* Dark semi-transparent overlay */
            --modal-content-bg: var(--card-dark-bg);
            --modal-button-bg: var(--red-button);
            --modal-button-text: var(--text-light);
            --modal-input-bg: var(--input-bg);
            --modal-input-border: var(--input-border);

            /* QR Payment Page Specific Colors */
            --button-blue: #007bff; /* Example blue, adjust if exact hex is found */
            --button-blue-hover: #0056b3;
            --light-border: #666666;
            --qr-border: #888888;
            --timer-bg: #5a5a5a; /* Darker grey for timer background */
            --timer-text: #ffffff;
        } 
.icon-back-button {
  background-color: #e3dbdb00;      /* Dark grey background */
  color: white;                /* White arrow */
  border: none;                /* No border */
  font-size: 20px;             /* Arrow size */
  padding: 5px 10px;           /* Chhoti padding */
  border-radius: 4px;          /* Slightly rounded corners */
  cursor: pointer;             /* Pointer on hover */
  transition: background-color 0.3s ease;
}

.icon-back-button:hover {
  background-color: #444;      /* Thoda dark on hover */
}
        body {
            font-family: 'Roboto', sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--primary-dark-bg);
            color: var(--text-light);
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .container {
            max-width: 450px;
            margin: 0 auto;
            background-color: var(--primary-dark-bg);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            box-shadow: var(--shadow-dark);
            position: relative; /* For chat icon and modals */
        }

        /* Page specific wrappers */
        .page-section {
            width: 100%;
            display: flex;
            flex-direction: column;
            flex-grow: 1; /* Allows content to fill space */
        }

        .page-section.hidden {
            display: none;
        }

        /* Common Header Styles */
        .header {
            background-color: var(--header-bg);
            padding: 15px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 1px solid var(--border-dark);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .header .back-arrow {
            font-size: 24px;
            color: var(--text-light);
            cursor: pointer;
            padding-right: 15px;
        }

        .header .title {
            font-size: 24px;
            font-weight: 500;
            flex-grow: 1;
            text-align: left;
            color: #ff0404;
        }

        .header .link {
            text-decoration: none;
            color: var(--text-light);
            font-size: 14px;
            padding-left: 15px;
            white-space: nowrap; /* Prevent wrapping */
        }

        /* --- Deposit Page Styles --- */
        .balance-card {
            background: linear-gradient(135deg, #ffa000, #ff6f00); /* Orange/Yellow Gradient */
            color: var(--text-light);
            padding: 20px;
            margin: 15px;
            border-radius: 8px;
            box-shadow: var(--shadow-dark);
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .balance-card .label {
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 5px;
            opacity: 0.8;
        }

        .balance-card .amount {
            font-size: 28px;
            font-weight: 700;
            display: flex;
            align-items: center;
        }

        .balance-card .refresh-icon {
            font-size: 18px;
            margin-left: 10px;
            cursor: pointer;
        }

        .section-header {
            font-size: 16px;
            font-weight: 500;
            color: var(--text-light);
            margin: 15px 15px 10px 15px;
        }

        .payment-methods {
            display: flex;
            justify-content: space-around;
            padding: 10px 15px;
            background-color: var(--card-dark-bg);
            margin: 0 15px 15px 15px;
            border-radius: 8px;
            box-shadow: var(--shadow-dark);
        }

        .payment-method-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            flex: 1;
            padding: 10px;
            border-radius: 8px;
            cursor: pointer;
            color: var(--text-subtle);
            font-size: 13px;
            transition: background-color 0.2s, color 0.2s;
            position: relative; /* For the plus icon */
        }

        .payment-method-item img {
            width: 40px;
            height: 40px;
            margin-bottom: 5px;
        }

        .payment-method-item .plus-icon {
            font-size: 10px;
            background-color: var(--green-text-accent);
            color: var(--text-light);
            border-radius: 50%;
            padding: 2px;
            position: absolute;
            top: 5px;
            right: 5px;
            width: 16px;
            height: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .payment-method-item.active {
            color: var(--text-light); /* Only color changes for active payment method */
        }
        .payment-method-item[data-channel="ff-pay"] img {
             background-color: var(--green-text-accent);
             border-radius: 50%;
             padding: 5px;
        }

        .channel-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin: 0 15px;
            padding: 15px;
            background-color: var(--card-dark-bg);
            border-radius: 8px;
            box-shadow: var(--shadow-dark);
        }

        .channel-item {
            background-color: var(--channel-inactive-bg);
            padding: 15px;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.2s;
            text-align: center;
            font-size: 14px;
            color: var(--text-light);
        }

        .channel-item.active {
            background-color: var(--channel-active-bg);
        }

        .channel-item .balance-range {
            font-size: 12px;
            color: var(--text-subtle);
            margin-top: 5px;
        }

        .deposit-amount-section {
            margin: 15px;
            padding: 15px;
            background-color: var(--card-dark-bg);
            border-radius: 8px;
            box-shadow: var(--shadow-dark);
        }

        .amount-buttons {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-top: 10px;
        }

        .amount-btn {
            background-color: var(--channel-inactive-bg);
            color: var(--text-light);
            padding: 10px 0;
            border-radius: 5px;
            text-align: center;
            font-size: 15px;
            font-weight: 500;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .amount-btn.active {
            background-color: var(--red-button);
        }

        .custom-amount-input {
            display: flex;
            align-items: center;
            margin-top: 15px;
            background-color: var(--input-bg);
            border: 1px solid var(--input-border);
            border-radius: 25px;
            padding: 5px 15px;
        }

        .custom-amount-input input {
            flex-grow: 1;
            background: none;
            border: none;
            outline: none;
            color: var(--text-light);
            font-size: 16px;
            padding: 5px 0;
        }

        .custom-amount-input .currency-symbol {
            color: var(--text-subtle);
            margin-right: 5px;
            font-size: 16px;
        }

        .custom-amount-input .clear-btn {
            background: none;
            border: none;
            color: var(--text-subtle);
            font-size: 18px;
            cursor: pointer;
            padding: 0 5px;
        }

        .deposit-button {
            width: 100%;
            background-color: var(--red-button);
            color: var(--text-light);
            padding: 12px;
            border: none;
            border-radius: 25px;
            font-size: 18px;
            font-weight: 500;
            cursor: pointer;
            margin-top: 20px;
            transition: background-color 0.2s;
            box-shadow: var(--shadow-dark);
        }

        .deposit-button:hover {
            background-color: var(--red-button-hover);
        }

        .recharge-instructions {
            margin: 15px;
            padding: 15px;
            background-color: var(--card-dark-bg);
            border-radius: 8px;
            box-shadow: var(--shadow-dark);
            color: var(--text-subtle);
            font-size: 13px;
        }

        .recharge-instructions ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .recharge-instructions li {
            margin-bottom: 8px;
            position: relative;
            padding-left: 18px;
        }

        .recharge-instructions li::before {
            content: '•';
            color: var(--green-text-accent);
            font-size: 20px;
            line-height: 1;
            position: absolute;
            left: 0;
            top: 2px;
        }

        /* --- Deposit History Page Styles --- */
        .filter-buttons {
            display: flex;
            justify-content: space-around;
            padding: 10px 15px;
            background-color: var(--card-dark-bg);
            border-bottom: 1px solid var(--border-dark);
            gap: 10px;
        }

        .filter-btn {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 8px 5px;
            background-color: var(--filter-button-bg);
            border-radius: 5px;
            font-size: 13px;
            font-weight: 500;
            color: var(--text-subtle);
            cursor: pointer;
            transition: background-color 0.2s, color 0.2s;
            height: 38px;
            box-sizing: border-box;
        }

        .filter-btn img {
            height: 18px;
            width: 18px;
            margin-right: 5px;
            filter: invert(100%);
        }
        .filter-btn[data-filter-type="all"] img {
            filter: none;
        }

        .filter-btn.active {
            background-color: var(--filter-button-active-bg);
            color: var(--filter-button-active-text);
        }
        .filter-btn.active img {
            filter: none;
        }

        .filter-content-area {
            padding: 10px 15px;
            background-color: var(--card-dark-bg);
            border-bottom: 1px solid var(--border-dark);
            display: flex;
            gap: 10px;
            flex-wrap: wrap; /* Allow wrapping for better responsiveness */
        }

        .filter-dropdown {
            flex: 1;
            min-width: 120px; /* Ensure dropdowns don't get too small */
            padding: 8px 10px;
            border: 1px solid var(--input-border);
            border-radius: 5px;
            background-color: var(--input-bg);
            color: var(--text-light);
            font-size: 14px;
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
            background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23b0b0b0%22%20d%3D%22M287%2069.9a15.8%2015.8%200%200%200-22.3%200L146.2%20188.7%2027.6%2069.9a15.8%2015.8%200%200%200-22.3%2022.3l129.8%20129.8a15.8%2015.8%200%200%200%2022.3%200L287%2092.2a15.8%2015.8%200%200%200%200-22.3z%22%2F%3E%3C%2Fsvg%3E');
            background-repeat: no-repeat;
            background-position: right 8px top 50%;
            background-size: 12px auto;
            cursor: pointer;
        }

        /* Date Time Chat Styles */
        .date-time-chat-container {
            display: flex; /* Changed from none to flex by default, hidden by JS */
            flex-direction: column;
            background-color: var(--chat-bg);
            border: 1px solid var(--chat-border);
            border-radius: 8px;
            margin: 10px 0; /* Adjust margin to sit within filter-content-area */
            overflow: hidden;
            box-shadow: var(--shadow-dark);
            max-height: 350px;
            width: 100%; /* Take full width of parent */
        }

        .date-time-chat-header {
            background-color: var(--chat-header-bg);
            padding: 10px 15px;
            font-weight: 500;
            border-bottom: 1px solid var(--chat-border);
            color: var(--text-light);
        }

        .chat-messages {
            flex-grow: 1;
            padding: 15px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            max-height: 180px;
            overflow-y: auto;
            margin-bottom: 10px;
        }

        .chat-message {
            max-width: 80%;
            padding: 8px 12px;
            border-radius: 15px;
            line-height: 1.4;
            font-size: 14px;
        }

        .chat-message.incoming {
            background-color: var(--chat-message-bg-incoming);
            color: var(--text-light);
            align-self: flex-start;
            border-bottom-left-radius: 2px;
        }

        .chat-message.outgoing {
            background-color: var(--chat-message-bg-outgoing);
            color: var(--text-light);
            align-self: flex-end;
            border-bottom-right-radius: 2px;
        }

        .chat-input-area {
            display: flex;
            flex-direction: column;
            padding: 10px 15px;
            border-top: 1px solid var(--chat-border);
            background-color: var(--card-dark-bg);
            gap: 10px;
        }

        .chat-input-area input,
        .chat-input-area select {
            width: 100%;
            border: 1px solid var(--input-border);
            border-radius: 20px;
            padding: 8px 15px;
            outline: none;
            font-size: 14px;
            box-sizing: border-box;
            background-color: var(--input-bg);
            color: var(--text-light);
        }
        .chat-input-area select option {
             background-color: var(--input-bg);
             color: var(--text-light);
        }

        .chat-input-area button {
            background-color: var(--red-button);
            color: var(--text-light);
            border: none;
            border-radius: 20px;
            padding: 8px 15px;
            cursor: pointer;
            font-weight: 500;
            transition: background-color 0.2s;
            width: 100%;
        }

        .chat-input-area button:hover {
            background-color: var(--red-button-hover);
        }

        /* Custom Month Picker Styles */
        .month-picker-container {
            display: flex; /* Changed from none to flex by default, hidden by JS */
            flex-direction: column;
            background-color: var(--month-picker-bg);
            border: 1px solid var(--border-dark);
            border-radius: 8px;
            width: 100%;
            max-width: 300px;
            margin: 0 auto;
            box-shadow: var(--shadow-dark);
            overflow: hidden;
            margin-bottom: 10px;
        }

        .month-picker-header {
            background-color: var(--month-picker-header-bg);
            color: var(--month-picker-header-text);
            padding: 15px;
            text-align: center;
            font-size: 18px;
            font-weight: 500;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 5px;
        }

        .month-picker-header .selected-month-year {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .month-picker-header .year-selector {
            display: flex;
            align-items: center;
            font-size: 24px;
            font-weight: 500;
        }

        .month-picker-header .year-selector button {
            background: none;
            border: none;
            color: var(--month-picker-header-text);
            font-size: 24px;
            cursor: pointer;
            padding: 0 10px;
            transition: opacity 0.2s;
        }
        .month-picker-header .year-selector button:hover {
            opacity: 0.8;
        }

        .month-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            padding: 15px;
        }

        .month-item {
            background-color: var(--month-item-bg);
            color: var(--month-picker-month-text);
            padding: 10px 5px;
            border-radius: 4px;
            text-align: center;
            font-size: 14px;
            cursor: pointer;
            transition: background-color 0.2s, color 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            height: 40px;
        }

        .month-item:hover {
            background-color: var(--month-item-hover-bg);
        }

        .month-item.selected {
            background-color: var(--month-picker-month-active-bg);
            color: var(--text-light);
            font-weight: 500;
        }

        .month-picker-actions {
            display: flex;
            justify-content: flex-end;
            padding: 10px 15px;
            gap: 10px;
            border-top: 1px solid var(--border-dark);
        }

        .month-picker-actions button {
            background: none;
            border: none;
            color: var(--month-picker-button-text);
            font-weight: 500;
            padding: 8px 12px;
            border-radius: 5px;
            cursor: pointer;
            text-transform: uppercase;
            transition: background-color 0.2s;
        }

        .month-picker-actions button:hover {
            background-color: rgba(255, 255, 255, 0.05);
        }

        .deposit-item-card {
            background-color: var(--card-dark-bg);
            margin: 15px;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid var(--border-dark);
            box-shadow: var(--shadow-dark);
            color: var(--text-light);
        }

        .deposit-item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px dashed var(--border-dark);
        }

        .deposit-item-header .deposit-label {
            background-color: var(--green-text-accent);
            color: var(--text-light);
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 14px;
            font-weight: 500;
        }

        .deposit-item-header .status {
            font-size: 15px;
            font-weight: 500;
        }
        .deposit-item-header .status.processing {
            color: var(--status-processing);
        }
        .deposit-item-header .status.success {
            color: var(--status-success);
        }
        .deposit-item-header .status.failed {
            color: var(--status-failed);
        }

        .deposit-details {
            display: flex;
            flex-direction: column;
            gap: 8px;
            font-size: 14px;
            color: var(--text-light);
        }

        .deposit-details .detail-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .deposit-details .label {
            color: var(--text-subtle);
            flex-shrink: 0;
            margin-right: 10px;
        }

        .deposit-details .value {
            font-weight: 500;
            text-align: right;
            flex-grow: 1;
        }

        .deposit-details .value.amount {
            color: var(--yellow-accent);
        }

        .deposit-details .order-copy {
            display: flex;
            align-items: center;
            justify-content: flex-end;
            flex-grow: 1;
        }

        .deposit-details .order-copy .copy-icon {
            font-size: 18px;
            margin-left: 8px;
            color: var(--text-subtle);
            cursor: pointer;
        }

        .no-more {
            text-align: center;
            color: var(--text-subtle);
            padding: 20px;
            font-size: 14px;
            margin-top: 20px;
        }

        /* Floating Chat Icon (Common) */
        .chat-icon {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: #f7bb34;
            color: white;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            z-index: 1001;
            transition: background-color 0.2s;
        }

        .chat-icon:hover {
            background-color: #e6a72e;
        }

        /* Date Range Picker Modal Styles */
        .date-range-modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--modal-overlay-bg);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .date-range-modal-overlay.show {
            opacity: 1;
            visibility: visible;
        }

        .date-range-modal-content {
            background-color: var(--modal-content-bg);
            padding: 20px;
            border-radius: 10px;
            box-shadow: var(--shadow-dark);
            width: 90%;
            max-width: 350px;
            display: flex;
            flex-direction: column;
            gap: 15px;
            transform: translateY(-20px);
            transition: transform 0.3s ease;
        }
        .date-range-modal-overlay.show .date-range-modal-content {
            transform: translateY(0);
        }

        .modal-header {
            font-size: 18px;
            font-weight: 500;
            text-align: center;
            color: var(--text-light);
            margin-bottom: 10px;
        }

        .modal-date-inputs {
            display: flex;
            gap: 10px;
            justify-content: space-between;
        }

        .modal-date-inputs label {
            flex: 1;
            display: flex;
            flex-direction: column;
            font-size: 13px;
            color: var(--text-subtle);
        }

        .modal-date-inputs input[type="date"] {
            width: 100%;
            padding: 8px;
            border: 1px solid var(--modal-input-border);
            border-radius: 5px;
            background-color: var(--modal-input-bg);
            color: var(--text-light);
            font-size: 14px;
            margin-top: 5px;
            box-sizing: border-box;
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
            background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2224%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%20fill%3D%22none%22%20stroke%3D%22%23b0b0b0%22%20stroke-width%3D%222%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%3E%3Crect%20x%3D%223%22%20y%3D%224%22%20width%3D%2218%22%20height%3D%2218%22%20rx%3D%222%22%22%20ry%3D%222%22%3E%3C%2Frect%3E%3Cline%20x1%3D%2216%22%20y1%3D%222%22%20x2%3D%2216%22%20y2%3D%226%22%3E%3C%2Fcline%3E%3Cline%20x1%3D%228%22%20y1%3D%222%22%20x2%3D%228%22%20y2%3D%226%22%3E%3C%2Fcline%3E%3Cline%20x1%3D%223%22%20y1%3D%2210%22%20x2%3D%2221%22%20y2%3D%2210%22%3E%3C%2Fcline%3E%3C%2Fsvg%3E');
            background-repeat: no-repeat;
            background-position: right 8px center;
            background-size: 18px;
        }

        .modal-quick-select-buttons {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }

        .modal-quick-select-buttons button {
            background-color: var(--filter-button-bg);
            color: var(--text-light);
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            font-size: 14px;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .modal-quick-select-buttons button:hover {
            background-color: #6a6a6a;
        }
        .modal-quick-select-buttons button.active {
            background-color: var(--green-text-accent);
        }

        .modal-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 10px;
        }

        .modal-actions button {
            background-color: var(--modal-button-bg);
            color: var(--modal-button-text);
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            font-size: 15px;
            font-weight: 500;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .modal-actions button:first-child {
            background-color: transparent;
            color: var(--text-subtle);
            border: 1px solid var(--text-subtle);
        }
        .modal-actions button:first-child:hover {
            background-color: rgba(255,255,255,0.1);
        }
        .modal-actions button:last-child:hover {
            background-color: var(--red-button-hover);
        }

        /* --- QR Payment Page Styles --- */
        .main-content {
            flex-grow: 1;
            padding: 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .card {
            background-color: var(--card-dark-bg);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 15px;
            width: 100%;
            box-shadow: var(--shadow-dark);
            text-align: center;
        }

        .transfer-details-card .detail-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 14px;
        }
        .transfer-details-card .detail-row .label {
            color: var(--text-subtle);
        }
        .transfer-details-card .detail-row .value {
            font-weight: 500;
        }
        .transfer-details-card .detail-row .copy-icon {
            margin-left: 5px;
            color: var(--text-subtle);
            cursor: pointer;
        }
        .transfer-details-card .amount {
            font-size: 24px;
            font-weight: 700;
            color: var(--green-text-accent); /* Use green for amount as per screenshot 1 (PWvCC.png) */
            margin-bottom: 15px;
            display: flex;
            justify-content: center;
            align-items: baseline;
        }
        .transfer-details-card .amount span {
            font-size: 16px; /* For currency symbol */
            margin-right: 5px;
        }

        .timer-section {
            background-color: var(--timer-bg);
            color: var(--timer-text);
            padding: 10px 20px;
            border-radius: 25px;
            font-size: 18px;
            font-weight: 500;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            box-shadow: var(--shadow-dark);
        }
        .timer-section .icon {
            font-size: 22px;
        }

        .qr-code-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            background-color: var(--card-dark-bg);
            border-radius: 8px;
            width: 100%;
            margin-bottom: 20px;
            box-shadow: var(--shadow-dark);
        }

        .qr-code-placeholder {
            width: 180px; /* Adjust size as needed */
            height: 180px; /* Adjust size as needed */
            border: 5px solid var(--qr-border);
            border-radius: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden; /* Ensure image fits within border */
            margin-bottom: 15px;
        }

        .qr-code-placeholder img {
            width: 100%;
            height: 100%;
            object-fit: contain; /* Ensure QR code is fully visible */
        }

        .qr-code-section p {
            font-size: 14px;
            color: var(--text-subtle);
            margin: 0 0 15px 0;
            text-align: center;
        }

        .download-button, .save-image-button {
            background-color: var(--button-blue);
            color: var(--text-light);
            padding: 10px 20px;
            border: none;
            border-radius: 25px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: background-color 0.2s;
            margin-bottom: 10px; /* Space between buttons */
            width: 80%; /* Make buttons fill more width */
            max-width: 250px;
        }

        .download-button:hover, .save-image-button:hover {
            background-color: var(--button-blue-hover);
        }

        .recharge-button-qr-page { /* Renamed to avoid conflict with Deposit page's button */
            width: 100%;
            background-color: var(--red-button);
            color: var(--text-light);
            padding: 12px;
            border: none;
            border-radius: 25px;
            font-size: 18px;
            font-weight: 500;
            cursor: pointer;
            margin-top: 20px;
            transition: background-color 0.2s;
            box-shadow: var(--shadow-dark);
        }

        .recharge-button-qr-page:hover {
            background-color: #c82333;
        }

        .instructions-card {
            background-color: var(--card-dark-bg);
            border-radius: 8px;
            padding: 20px;
            margin-top: 15px;
            width: 100%;
            box-shadow: var(--shadow-dark);
        }

        .instructions-card h4 {
            color: var(--text-light);
            font-size: 16px;
            margin-top: 0;
            margin-bottom: 10px;
        }

        .instructions-card ol {
            list-style: decimal;
            padding-left: 20px;
            margin: 0;
            color: var(--text-subtle);
            font-size: 13px;
            line-height: 1.5;
        }

        .instructions-card ol li {
            margin-bottom: 8px;
        }
        .instructions-card ol li strong {
            color: var(--green-text-accent);
        }
    </style>
</head>
<body>
    <div class="container">

        <!-- DEPOSIT PAGE SECTION -->
        <div class="page-section" id="depositPage">
            <header class="header">
              <button class="icon-back-button" onclick="window.location.href='1..html'">&lt;</button>
                <div class="title">Deposit</div>
                <a href="#" class="link" id="showDepositHistoryLink">Deposit history</a>
            </header>

            <div class="balance-card">
                <div class="label">Balance</div>
                <div class="amount">
                    ₹<span id="currentBalance">0.00</span> <span class="refresh-icon">↻</span>
                </div>
            </div>

            <div class="section-header">Select channel</div>
            <div class="payment-methods">
                <div class="payment-method-item" data-channel="ark-pay">
                    <img src="https://via.placeholder.com/40/808080/ffffff?text=A" alt="ARK-PAY">
                    <span>ARK-PAY</span>
                    <span class="plus-icon">+10%</span>
                </div>
                <div class="payment-method-item" data-channel="super-pay">
                    <img src="https://via.placeholder.com/40/808080/ffffff?text=S" alt="SUPER-PAY">
                    <span>SUPER-PAY</span>
                </div>
                <div class="payment-method-item" data-channel="ff-pay">
                    <img src="https://via.placeholder.com/40/28a745/ffffff?text=F" alt="FF-PAY QR">
                    <span>FF-PAY QR</span>
                    <span class="plus-icon">+10%</span>
                </div>
            </div>

            <div class="channel-grid" id="channelGrid">
                <div class="channel-item active" data-channel-id="APP-Icepay">
                    APP-Icepay
                    <div class="balance-range">Balance:100 - 50K</div>
                </div>
                <div class="channel-item" data-channel-id="APP-7Days">
                    APP-7Days
                    <div class="balance-range">Balance:500 - 50K</div>
                </div>
                <div class="channel-item" data-channel-id="APP-super">
                    APP-super
                    <div class="balance-range">Balance:500 - 50K</div>
                </div>
                <div class="channel-item" data-channel-id="APP-Himos">
                    APP-Himos
                    <div class="balance-range">Balance:500 - 50K</div>
                </div>
                <div class="channel-item" data-channel-id="APP-Magicpay">
                    APP-Magicpay
                    <div class="balance-range">Balance:500 - 50K</div>
                </div>
                <div class="channel-item" data-channel-id="APP-Upay">
                    APP-Upay
                    <div class="balance-range">Balance:500 - 50K</div>
                </div>
                <div class="channel-item" data-channel-id="APP-dragon pay">
                    APP-dragon pay
                    <div class="balance-range">Balance:500 - 50K</div>
                </div>
                <div class="channel-item" data-channel-id="APP-Ok Pay">
                    APP-Ok Pay
                    <div class="balance-range">Balance:500 - 50K</div>
                </div>
            </div>

            <div class="section-header">Deposit amount</div>
            <div class="deposit-amount-section">
                <div class="amount-buttons">
                    <div class="amount-btn active" data-amount="500">₹ 500</div>
                    <div class="amount-btn" data-amount="2000">₹ 2K</div>
                    <div class="amount-btn" data-amount="5000">₹ 5K</div>
                    <div class="amount-btn" data-amount="10000">₹ 10K</div>
                    <div class="amount-btn" data-amount="20000">₹ 20K</div>
                    <div class="amount-btn" data-amount="50000">₹ 50K</div>
                </div>

                <div class="custom-amount-input">
                    <span class="currency-symbol">₹</span>
                    <input type="number" id="depositInput" value="500" placeholder="Enter amount">
                    <button class="clear-btn" id="clearInputBtn">✕</button>
                </div>

                <button class="deposit-button" id="proceedToQrPayment">Deposit</button>
            </div>

            <div class="section-header">Recharge instructions</div>
            <div class="recharge-instructions">
                <ul>
                    <li>First Deposit must be 2000</li>
                    <li>If the transfer time is up, please fill out the deposit form again.</li>
                    <li>The transfer amount must match the order you created, otherwise the money cannot be credited successfully.</li>
                    <li>If you transfer the wrong amount, our company will not be responsible for the lost amount!</li>
                    <li>Note: do not cancel the deposit order after the money has been transferred.</li>
                </ul>
            </div>
        </div>

        <!-- DEPOSIT HISTORY PAGE SECTION -->
        <div class="page-section hidden" id="depositHistoryPage">
            <header class="header">
                <div class="back-arrow" onclick="showDepositPage()">&lt;</div>
                <div class="title">Deposit history</div>
                <!-- Kept '+' sign as per screenshot for history page header -->
                <a href="#" class="link" onclick="showDepositPage()">Deposit</a>
            </header>

            <div class="filter-buttons">
                <div class="filter-btn active" data-filter-type="all">
                    <img src="https://via.placeholder.com/18/28a745/ffffff?text=A" alt="All"> All
                </div>
                <div class="filter-btn" data-filter-type="upi-app">
                    <img src="https://via.placeholder.com/18/6c757d/ffffff?text=U" alt="UPI-APP"> UPI-APP
                </div>
                <div class="filter-btn" data-filter-type="upi-manual">
                    <img src="https://via.placeholder.com/18/6c757d/ffffff?text=M" alt="UPI-Manual"> UPI-Manual
                </div>
                <div class="filter-btn" data-filter-type="other">
                    <img src="https://via.placeholder.com/18/6c757d/ffffff?text=O"> Other
                </div>
            </div>

            <!-- Filter Content Area - Will contain either dropdowns, month picker, or chat -->
            <div class="filter-content-area" id="mainFilterContent">
                <!-- Dropdowns (Initially shown, hidden when month picker or chat is active) -->
                <div class="filter-row" id="dateFilterDropdowns">
                    <select class="filter-dropdown" id="statusFilterDropdown">
                        <option value="all-status">All Status</option>
                        <option value="processing">Processing</option>
                        <option value="success">Success</option>
                        <option value="failed">Failed</option>
                    </select>
                    <select class="filter-dropdown" id="timeFilterDropdown">
                        <option value="all-time">All Time</option>
                        <option value="2024-5-20/2024-5-31">2024-5-20/2024-5-31</option>
                        <option value="2025-01-01/2025-01-31">2025-01-01/2025-01-31</option>
                        <option value="2025-02-01/2025-02-28">2025-02-01/2025-02-28</option>
                    </select>
                </div>

                <!-- Custom Month Picker (Hidden by default, shown for "All" filter) -->
                <div class="month-picker-container hidden" id="monthPicker">
                    <div class="month-picker-header">
                        <span class="selected-month-year" id="selectedMonthYearDisplay">Nov. 2018</span>
                        <div class="year-selector">
                            <button id="prevYear">&lt;</button>
                            <span id="currentYearDisplay">2018</span>
                            <button id="nextYear">&gt;</button>
                        </div>
                    </div>
                    <div class="month-grid" id="monthGrid">
                        <!-- Months will be populated by JavaScript -->
                    </div>
                    <div class="month-picker-actions">
                        <button id="monthPickerCancel">ABBRECHEN</button>
                        <button id="monthPickerOk">OK</button>
                    </div>
                </div>

                <!-- Date/Time Chat Interface (Hidden by default, shown for UPI-APP/UPI-Manual) -->
                <div class="date-time-chat-container hidden" id="dateTimeChat">
                    <div class="date-time-chat-header">Select Date and Time</div>
                    <div class="chat-messages" id="chatMessages">
                        <div class="chat-message incoming">Please select the **Time** first.</div>
                    </div>
                    <div class="chat-input-area">
                        <input type="time" id="chatInput" placeholder="HH:MM">
                        <select id="chatYearSelect" style="display: none;"></select>
                        <button id="sendDateBtn">Next</button>
                    </div>
                </div>
            </div>

            <!-- Deposit Items will be dynamically rendered here -->
            <div id="depositHistoryList">
                <!-- Dynamic deposit items will be inserted here by JavaScript -->
            </div>

            <div class="no-more">
                No more
            </div>
        </div>

        <!-- QR PAYMENT PAGE SECTION (New Page) -->
        <div class="page-section hidden" id="qrPaymentPage">
            <header class="header">
                <div class="back-arrow" onclick="showDepositPage()">&#8592;</div>
                <div class="title">Pay Now</div>
                <div class="link"></div> <!-- Placeholder for right alignment -->
            </header>

            <div class="main-content">
                <div class="card transfer-details-card">
                    <div class="amount">
                        <span>₹</span><span id="qrPageAmount">2,000.00</span> <!-- Target for dynamic amount -->
                    </div>
                    <div class="detail-row">
                        <span class="label">Payment Type</span>
                        <span class="value">UPI Manual</span>
                    </div>
                    <div class="detail-row">
                        <span class="label">Order number</span>
                        <span class="value">
                            12345678901234567890
                            <span class="copy-icon" onclick="copyText('12345678901234567890')">📋</span>
                        </span>
                    </div>
                </div>

                <div class="timer-section">
                    <span class="icon">🕒</span>
                    <span id="countdownTimer">05:00</span>
                </div>

                <div class="qr-code-section">
                    <div class="qr-code-placeholder">
                        <!-- QR Code Image Source -->
                        <img id="qrCodeImage" src="scanner.jpg" alt="QR Code">
                    </div>
                    <p>Scan the code or copy the UPL ID to pay</p>
                    <button class="download-button" id="downloadQrBtn">Download</button>
                    <button class="save-image-button" id="saveQrBtn">Save Image</button>
                </div>

                <button class="recharge-button-qr-page">I have completed the recharge</button>

                <div class="card instructions-card">
                    <h4>Important Notes:</h4>
                    <ol>
                        <li>Please copy the payment number to the payment app for payment.</li>
                        <li>If the transfer time is up, please fill out the deposit form again.</li>
                        <li>The transfer amount must match the order you created, otherwise the money cannot be credited successfully.</li>
                        <li>If you transfer the wrong amount, our company will not be responsible for the lost amount!</li>
                        <li>Note: do not cancel the deposit order after the money has been transferred.</li>
                        <li>Deposit through this channel will get an additional <Strong>10% cashback.</Strong></li>
                    </ol>
                </div>
            </div>
        </div>
    </div>

    <!-- Floating Chat Icon (Common for all pages) -->
    <div class="chat-icon">💬</div>

    <!-- Date Range Picker Modal (Common for Deposit History Page) -->
    <div class="date-range-modal-overlay" id="dateRangeModal">
        <div class="date-range-modal-content">
            <div class="modal-header">Select Date Range</div>
            <div class="modal-date-inputs">
                <label>
                    From:
                    <input type="date" id="modalFromDate">
                </label>
                <label>
                    To:
                    <input type="date" id="modalToDate">
                </label>
            </div>
            <div class="modal-quick-select-buttons">
                <button data-range="today">Today</button>
                <button data-range="yesterday">Yesterday</button>
                <button data-range="last7days">Last 7 Days</button>
                <button data-range="last30days">Last 30 Days</button>
                <button data-range="thisMonth">This Month</button>
                <button data-range="lastMonth">Last Month</button>
            </div>
            <div class="modal-actions">
                <button id="modalCancelBtn">Cancel</button>
                <button id="modalApplyBtn">Apply</button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- Page Elements ---
            const depositPage = document.getElementById('depositPage');
            const depositHistoryPage = document.getElementById('depositHistoryPage');
            const qrPaymentPage = document.getElementById('qrPaymentPage');

            // --- Deposit Page Elements ---
            const showDepositHistoryLink = document.getElementById('showDepositHistoryLink');
            const currentBalance = document.getElementById('currentBalance');
            const amountButtons = document.querySelectorAll('.deposit-amount-section .amount-btn');
            const depositInput = document.getElementById('depositInput');
            const clearInputBtn = document.getElementById('clearInputBtn');
            const paymentMethodItems = document.querySelectorAll('.payment-method-item');
            const channelItems = document.querySelectorAll('.channel-item');
            const proceedToQrPaymentBtn = document.getElementById('proceedToQrPayment');

            // --- Deposit History Page Elements ---
            const filterButtons = document.querySelectorAll('.filter-btn');
            const mainFilterContent = document.getElementById('mainFilterContent');
            const dateFilterDropdowns = document.getElementById('dateFilterDropdowns');
            const dateTimeChat = document.getElementById('dateTimeChat');
            const monthPicker = document.getElementById('monthPicker');
            const timeFilterDropdown = document.getElementById('timeFilterDropdown');
            const depositHistoryList = document.getElementById('depositHistoryList'); // Container for dynamic history items

            // Date Range Modal elements (for Deposit History)
            const dateRangeModal = document.getElementById('dateRangeModal');
            const modalFromDate = document.getElementById('modalFromDate');
            const modalToDate = document.getElementById('modalToDate');
            const modalQuickSelectButtons = document.querySelectorAll('.modal-quick-select-buttons button');
            const modalCancelBtn = document.getElementById('modalCancelBtn');
            const modalApplyBtn = document.getElementById('modalApplyBtn');

            // Chat related elements (for Deposit History)
            const chatMessages = document.getElementById('chatMessages');
            const chatInput = document.getElementById('chatInput');
            const chatYearSelect = document.getElementById('chatYearSelect');
            const sendDateBtn = document.getElementById('sendDateBtn');

            // Month Picker related elements (for Deposit History)
            const selectedMonthYearDisplay = document.getElementById('selectedMonthYearDisplay');
            const currentYearDisplay = document.getElementById('currentYearDisplay');
            const prevYearBtn = document.getElementById('prevYear');
            const nextYearBtn = document.getElementById('nextYear');
            const monthGrid = document.getElementById('monthGrid');
            const monthPickerCancelBtn = document.getElementById('monthPickerCancel');
            const monthPickerOkBtn = document.getElementById('monthPickerOk');

            // QR Payment Page elements (for countdown and dynamic amount)
            const countdownTimerElement = document.getElementById('countdownTimer');
            const qrPageAmountDisplay = document.getElementById('qrPageAmount');
            const qrCodeImage = document.getElementById('qrCodeImage');
            const downloadQrBtn = document.getElementById('downloadQrBtn');
            const saveQrBtn = document.getElementById('saveQrBtn');


            let currentStep = 0; // 0: Time, 1: Date, 2: Year (for chat)
            let selectedTime = null;
            let selectedDate = null; // Stores 'YYYY-MM-DD'
            let selectedYearChat = null;

            let currentMonthPickerYear;
            let selectedMonthPickerMonth = new Date().getMonth(); // 0-indexed
            let selectedMonthPickerYear = new Date().getFullYear();

            const monthNames = ["Jan", "Feb", "Mär", "Apr", "Mai", "Jun", "Jul", "Aug", "Sep", "Okt", "Nov", "Dez"];

            // Variable to store the selected deposit amount
            let selectedDepositAmount = 500; // Default value, matches initial input value

            // Array to store deposit history dynamically
            let depositHistory = [];

            // --- Page Switching Functions ---
            // Function to show only one page and hide others
            function showPage(pageToShow) {
                depositPage.classList.add('hidden');
                depositHistoryPage.classList.add('hidden');
                qrPaymentPage.classList.add('hidden');

                pageToShow.classList.remove('hidden');

                // If navigating to QR payment page, start the timer
                if (pageToShow === qrPaymentPage) {
                    startCountdownTimer();
                    // Update the amount displayed on the QR page
                    qrPageAmountDisplay.textContent = parseFloat(selectedDepositAmount).toFixed(2);
                } else {
                    stopCountdownTimer(); // Stop timer if navigating away
                }

                // If navigating to deposit history page, render the history
                if (pageToShow === depositHistoryPage) {
                    renderDepositHistory();
                }
            }

            window.showDepositPage = function() {
                showPage(depositPage);
            }

            window.showDepositHistoryPage = function() {
                showPage(depositHistoryPage);
                showHistoryFilterComponent('dropdowns');
                filterButtons.forEach(b => b.classList.remove('active'));
                document.querySelector('.filter-btn[data-filter-type="all"]').classList.add('active');
            }

            function showQrPaymentPage() {
                showPage(qrPaymentPage);
            }

            window.goBack = function() {
                if (!depositHistoryPage.classList.contains('hidden')) {
                    showDepositPage();
                } else if (!qrPaymentPage.classList.contains('hidden')) {
                    showDepositPage(); // Go back to deposit from QR page
                } else {
                    console.log("Already on deposit page, cannot go back further.");
                }
            }

            // Bind link to switch to Deposit History page
            showDepositHistoryLink.addEventListener('click', (e) => {
                e.preventDefault(); // Prevent default link behavior
                showDepositHistoryPage();
            });

            // Bind Deposit button to show QR Payment Page and add to history
            proceedToQrPaymentBtn.addEventListener('click', () => {
                // Get the current value from the input field as the selected amount
                selectedDepositAmount = parseFloat(depositInput.value);
                if (isNaN(selectedDepositAmount) || selectedDepositAmount <= 0) {
                    alert("Please enter a valid deposit amount.");
                    return;
                }

                // Add new deposit entry to history
                const now = new Date();
                const orderNumber = 'DIU' + now.getTime(); // Simple unique order number
                const depositTime = now.toLocaleString('en-IN', {
                    year: 'numeric', month: '2-digit', day: '2-digit',
                    hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: true
                }).replace(',', ''); // Format: DD/MM/YYYY HH:MM:SS AM/PM

                const newDeposit = {
                    amount: selectedDepositAmount,
                    type: 'UPI Manual', // Assuming this for now, could be dynamic
                    time: depositTime,
                    orderNumber: orderNumber,
                    status: 'processing' // Initial status
                };
                depositHistory.push(newDeposit);
                console.log("New deposit added:", newDeposit);

                showQrPaymentPage();
            });


            // --- Deposit Page Logic ---
            currentBalance.textContent = '0.00';

            // Amount button click handler
            amountButtons.forEach(button => {
                button.addEventListener('click', () => {
                    amountButtons.forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                    depositInput.value = button.dataset.amount;
                    selectedDepositAmount = parseFloat(button.dataset.amount); // Update selected amount
                });
            });

            // Handle manual input change to deselect amount buttons
            depositInput.addEventListener('input', () => {
                amountButtons.forEach(btn => btn.classList.remove('active'));
                selectedDepositAmount = parseFloat(depositInput.value) || 0; // Update selected amount
            });


            // Clear input button handler
            clearInputBtn.addEventListener('click', () => {
                depositInput.value = '';
                amountButtons.forEach(btn => btn.classList.remove('active'));
                selectedDepositAmount = 0; // Reset selected amount
            });

            // Update active state for payment methods
            paymentMethodItems.forEach(item => {
                item.addEventListener('click', () => {
                    paymentMethodItems.forEach(pm => pm.classList.remove('active'));
                    item.classList.add('active');
                    console.log('Payment method selected:', item.dataset.channel);
                });
            });

            // Update active state for channels
            channelItems.forEach(item => {
                item.addEventListener('click', () => {
                    channelItems.forEach(ch => ch.classList.remove('active'));
                    item.classList.add('active');
                    console.log('Channel selected:', item.dataset.channelId);
                });
            });

            // Initial active states for Deposit Page
            document.querySelector('.payment-method-item[data-channel="ark-pay"]').classList.add('active');
            document.querySelector('.channel-item[data-channel-id="APP-Icepay"]').classList.add('active');
            // Set the initial selected deposit amount from the default active button/input
            selectedDepositAmount = parseFloat(depositInput.value);


            // --- Deposit History Page Logic ---

            // Function to render deposit history items dynamically
            function renderDepositHistory() {
                depositHistoryList.innerHTML = ''; // Clear existing list
                if (depositHistory.length === 0) {
                    depositHistoryList.innerHTML = '<div class="no-more">No deposit history yet.</div>';
                    return;
                }

                // Render in reverse order (newest first)
                for (let i = depositHistory.length - 1; i >= 0; i--) {
                    const deposit = depositHistory[i];
                    const statusClass = deposit.status; // 'processing', 'success', 'failed'

                    const depositCardHtml = `
                        <div class="deposit-item-card">
                            <div class="deposit-item-header">
                                <span class="deposit-label">Deposit</span>
                                <span class="status ${statusClass}">${deposit.status.charAt(0).toUpperCase() + deposit.status.slice(1)}</span>
                            </div>
                            <div class="deposit-details">
                                <div class="detail-row"><span class="label">Balance</span><span class="value amount">₹${deposit.amount.toFixed(2)}</span></div>
                                <div class="detail-row"><span class="label">Type</span><span class="value">${deposit.type}</span></div>
                                <div class="detail-row"><span class="label">Time</span><span class="value">${deposit.time}</span></div>
                                <div class="detail-row"><span class="label">Order number</span><span class="value order-copy">${deposit.orderNumber} <span class="copy-icon" onclick="copyText('${deposit.orderNumber}')">📋</span></span></div>
                            </div>
                        </div>
                    `;
                    depositHistoryList.insertAdjacentHTML('beforeend', depositCardHtml);
                }
            }


            function showHistoryFilterComponent(componentId) {
                dateFilterDropdowns.classList.add('hidden');
                dateTimeChat.classList.add('hidden');
                monthPicker.classList.add('hidden');

                if (componentId === 'dropdowns') {
                    dateFilterDropdowns.classList.remove('hidden');
                } else if (componentId === 'chat') {
                    dateTimeChat.classList.remove('hidden');
                    resetChat();
                    chatMessages.scrollTop = chatMessages.scrollHeight;
                } else if (componentId === 'monthPicker') {
                    monthPicker.classList.remove('hidden');
                    renderMonthPicker();
                }
            }

            function showDateRangeModal() {
                dateRangeModal.classList.add('show');
                const today = new Date().toISOString().split('T')[0];
                modalFromDate.value = today;
                modalToDate.value = today;
                modalQuickSelectButtons.forEach(btn => btn.classList.remove('active'));
            }

            function hideDateRangeModal() {
                dateRangeModal.classList.remove('show');
            }

            // Chat Related Functions
            function populateYearSelectForChat() {
                chatYearSelect.innerHTML = '';
                const currentYear = new Date().getFullYear();
                for (let i = currentYear - 5; i <= currentYear + 5; i++) {
                    const option = document.createElement('option');
                    option.value = i;
                    option.textContent = i;
                    if (i === currentYear) {
                        option.selected = true;
                    }
                    chatYearSelect.appendChild(option);
                }
            }
            populateYearSelectForChat();

            function addChatMessage(type, text) {
                const msgDiv = document.createElement('div');
                msgDiv.classList.add('chat-message', type);
                msgDiv.innerHTML = text;
                chatMessages.appendChild(msgDiv);
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }

            function resetChat() {
                currentStep = 0;
                selectedTime = null;
                selectedDate = null;
                selectedYearChat = null;
                chatInput.type = 'time';
                chatInput.value = '';
                chatInput.style.display = 'block';
                chatYearSelect.style.display = 'none';
                sendDateBtn.textContent = 'Next';
                sendDateBtn.style.display = 'block';
                chatMessages.innerHTML = '<div class="chat-message incoming">Please select the **Time** first.</div>';
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }

            // Month Picker Related Functions
            function renderMonthPicker() {
                currentYearDisplay.textContent = currentMonthPickerYear;
                selectedMonthYearDisplay.textContent = `${monthNames[selectedMonthPickerMonth]}. ${currentMonthPickerYear}`;

                monthGrid.innerHTML = '';
                monthNames.forEach((month, index) => {
                    const monthItem = document.createElement('div');
                    monthItem.classList.add('month-item');
                    monthItem.textContent = month;
                    monthItem.dataset.monthIndex = index;

                    if (index === selectedMonthPickerMonth && currentMonthPickerYear === selectedMonthPickerYear) {
                         monthItem.classList.add('selected');
                    }

                    monthItem.addEventListener('click', () => {
                        document.querySelectorAll('.month-item').forEach(item => item.classList.remove('selected'));
                        monthItem.classList.add('selected');
                        selectedMonthPickerMonth = parseInt(monthItem.dataset.monthIndex);
                        selectedMonthPickerYear = currentMonthPickerYear;
                        selectedMonthYearDisplay.textContent = `${monthNames[selectedMonthPickerMonth]}. ${selectedMonthPickerYear}`;
                    });
                    monthGrid.appendChild(monthItem);
                });
            }
            currentMonthPickerYear = new Date().getFullYear();

            // --- Event Listeners for Deposit History Page ---
            filterButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    filterButtons.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');

                    const filterType = this.getAttribute('data-filter-type');

                    if (filterType === 'all') {
                        showHistoryFilterComponent('monthPicker');
                        currentMonthPickerYear = new Date().getFullYear();
                        selectedMonthPickerMonth = new Date().getMonth();
                        selectedMonthPickerYear = new Date().getFullYear();
                        renderMonthPicker();
                    } else if (filterType === 'upi-manual' || filterType === 'upi-app') {
                        showHistoryFilterComponent('chat');
                    } else {
                        showHistoryFilterComponent('dropdowns');
                    }
                });
            });

            timeFilterDropdown.addEventListener('focus', () => {
                showDateRangeModal();
                timeFilterDropdown.blur();
            });

            modalQuickSelectButtons.forEach(button => {
                button.addEventListener('click', function() {
                    modalQuickSelectButtons.forEach(btn => btn.classList.remove('active'));
                    this.classList.add('active');

                    const range = this.dataset.range;
                    const today = new Date();
                    let fromDate = new Date();
                    let toDate = new Date();

                    switch (range) {
                        case 'today':
                            break;
                        case 'yesterday':
                            fromDate.setDate(today.getDate() - 1);
                            toDate.setDate(today.getDate() - 1);
                            break;
                        case 'last7days':
                            fromDate.setDate(today.getDate() - 6);
                            break;
                        case 'last30days':
                            fromDate.setDate(today.getDate() - 29);
                            break;
                        case 'thisMonth':
                            fromDate = new Date(today.getFullYear(), today.getMonth(), 1);
                            toDate = new Date(today.getFullYear(), today.getMonth() + 1, 0);
                            break;
                        case 'lastMonth':
                            fromDate = new Date(today.getFullYear(), today.getMonth() - 1, 1);
                            toDate = new Date(today.getFullYear(), today.getMonth(), 0);
                            break;
                    }
                    modalFromDate.value = fromDate.toISOString().split('T')[0];
                    modalToDate.value = toDate.toISOString().split('T')[0];
                });
            });

            modalCancelBtn.addEventListener('click', () => {
                hideDateRangeModal();
            });

            modalApplyBtn.addEventListener('click', () => {
                const fromDate = modalFromDate.value;
                const toDate = modalToDate.value;

                if (!fromDate || !toDate) {
                    alert('Please select both From and To dates.');
                    return;
                }
                if (new Date(fromDate) > new Date(toDate)) {
                    alert('From Date cannot be after To Date.');
                    return;
                }

                alert(`Applying filter for: ${fromDate} to ${toDate}`);
                console.log(`Filtering data from ${fromDate} to ${toDate}`);
                hideDateRangeModal();
                timeFilterDropdown.querySelector('option[value="all-time"]').textContent = `${fromDate} to ${toDate}`;
                timeFilterDropdown.value = 'all-time';
            });

            sendDateBtn.addEventListener('click', () => {
                let inputValue = chatInput.value;

                if (currentStep === 0) {
                    if (!inputValue) {
                        alert('Please select a time.');
                        return;
                    }
                    selectedTime = inputValue;
                    addChatMessage('outgoing', `Time: ${selectedTime}`);
                    addChatMessage('incoming', 'Now please select the **Date** (day and month).');
                    chatInput.type = 'date';
                    chatInput.value = '';
                    currentStep = 1;
                } else if (currentStep === 1) {
                    if (!inputValue) {
                        alert('Please select a date.');
                        return;
                    }
                    selectedDate = inputValue;
                    addChatMessage('outgoing', `Date: ${selectedDate}`);
                    addChatMessage('incoming', 'Finally, please select the **Year**.');
                    chatInput.style.display = 'none';
                    chatYearSelect.style.display = 'block';
                    sendDateBtn.textContent = 'Confirm';
                    currentStep = 2;
                } else if (currentStep === 2) {
                    selectedYearChat = chatYearSelect.value;
                    if (!selectedYearChat) {
                        alert('Please select a year.');
                        return;
                    }
                    addChatMessage('outgoing', `Year: ${selectedYearChat}`);

                    const combinedDate = `${selectedYearChat}-${selectedDate.substring(5)}`;
                    const finalDateTimeFull = `${combinedDate} ${selectedTime}`;

                    addChatMessage('incoming', `You selected: ${finalDateTimeFull}. Filtering results...`);
                    console.log('Filtering history for:', finalDateTimeFull);

                    const resetBtnHtml = '<button onclick="resetChatFromButton()" style="background: var(--green-text-accent); color: white; border: none; padding: 5px 10px; border-radius: 5px; cursor: pointer; margin-left: 5px;">Reset</button>';
                    addChatMessage('incoming', `You can select new date/time, or ${resetBtnHtml}`);

                    chatInput.style.display = 'none';
                    chatYearSelect.style.display = 'none';
                    sendDateBtn.style.display = 'none';
                }
            });

            window.resetChatFromButton = function() {
                resetChat();
            };

            prevYearBtn.addEventListener('click', () => {
                currentMonthPickerYear--;
                renderMonthPicker();
            });

            nextYearBtn.addEventListener('click', () => {
                currentMonthPickerYear++;
                renderMonthPicker();
            });

            monthPickerCancelBtn.addEventListener('click', () => {
                showHistoryFilterComponent('dropdowns');
                filterButtons.forEach(b => b.classList.remove('active'));
                document.querySelector('.filter-btn[data-filter-type="all"]').classList.add('active');
            });

            monthPickerOkBtn.addEventListener('click', () => {
                if (selectedMonthPickerMonth !== null && selectedMonthPickerYear !== null) {
                    const selectedMonthName = monthNames[selectedMonthPickerMonth];
                    const selectedYear = selectedMonthPickerYear;
                    const result = `${selectedMonthName} ${selectedYear}`;
                    alert(`Selected month and year: ${result}`);
                    console.log(`Selected month for filtering: Month Index ${selectedMonthPickerMonth}, Year ${selectedYear}`);
                    showHistoryFilterComponent('dropdowns');
                    timeFilterDropdown.querySelector('option[value="all-time"]').textContent = `${selectedMonthName}. ${selectedYear}`;
                    timeFilterDropdown.value = 'all-time';
                } else {
                    alert('Please select a month.');
                }
            });

            // Functionality to copy text to clipboard (common for order number)
            window.copyText = function(text) {
                navigator.clipboard.writeText(text).then(() => {
                    alert('Copied to clipboard: ' + text);
                }).catch(err => {
                    console.error('Failed to copy: ', err);
                });
            }

            // --- QR Payment Page Specific Logic (Timer & Download) ---
            const initialTime = 5 * 60;
            let timeLeft = initialTime;
            let timerInterval;

            function updateTimer() {
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;

                countdownTimerElement.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;

                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    countdownTimerElement.textContent = "00:00";
                    alert("Time's up! Please create a new order if you wish to proceed.");
                } else {
                    timeLeft--;
                }
            }

            function startCountdownTimer() {
                if (timerInterval) {
                    clearInterval(timerInterval);
                }
                timeLeft = initialTime;
                timerInterval = setInterval(updateTimer, 1000);
                updateTimer();
            }

            function stopCountdownTimer() {
                if (timerInterval) {
                    clearInterval(timerInterval);
                }
            }

            // Function to download the QR code image
            function downloadQrCode() {
                const imageUrl = qrCodeImage.src;
                if (!imageUrl) {
                    alert("QR Code image not found.");
                    return;
                }

                const link = document.createElement('a');
                link.href = imageUrl;
                link.download = 'DIUWINNER_QR_Code.png';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            }

            downloadQrBtn.addEventListener('click', downloadQrCode);
            saveQrBtn.addEventListener('click', downloadQrCode);

            // Initial setup on page load: Show Deposit page by default
            showPage(depositPage);
        });
    </script>
</body>
</html>
